generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

// ---- enums ----
enum AccountStatus {
  active
  frozen
}

enum TransactionStatus {
  pending
  completed
  failed
}

enum EntryType {
  debit
  credit
}

// ---- models ----
model Account {
  id            String        @id @default(uuid())
  userId        String
  accountType   String
  currency      String
  status        AccountStatus @default(active)
  createdAt     DateTime      @default(now())

  ledgerEntries LedgerEntry[]
}

model Transaction {
  id              String            @id @default(uuid())
  transactionType String
  amount          Decimal           @db.Decimal()
  currency        String
  status          TransactionStatus
  description     String?
  createdAt       DateTime          @default(now())

  ledgerEntries   LedgerEntry[]
}

model LedgerEntry {
  id            String     @id @default(uuid())
  accountId     String
  transactionId String
  entryType     EntryType
  amount        Decimal    @db.Decimal()
  createdAt     DateTime   @default(now())

  account       Account     @relation(fields: [accountId], references: [id])
  transaction   Transaction @relation(fields: [transactionId], references: [id])

  @@index([accountId, createdAt])
}
